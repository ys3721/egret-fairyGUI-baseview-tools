# -*- coding:utf8 -*-
import asyncio
import struct
import time

import websockets
import robot.pizza as pizza


async def hello():
    async with websockets.connect(
            'ws://localhost:8080') as websocket:
        hand_msg = struct.pack('!hh', 4, 510)
        await websocket.send(hand_msg)
        greeting = await websocket.recv()
        print(greeting)

        #login_msg_bytes = b'\x01\x3E\x04\xB1\x00\x01\x32\x00\x01\x31\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x15\x75\x64\x69\x64\x2D\x66\x69\x78\x65\x64\x2D\x31\x32\x33\x34\x35\x36\x37\x38\x39\x30\x00\x05\x30\x2E\x30\x2E\x30\x00\x05\x7A\x68\x5F\x43\x4E\x00\x7C\x7B\x22\x70\x6C\x61\x74\x66\x6F\x72\x6D\x22\x3A\x32\x30\x2C\x22\x63\x68\x61\x6E\x6E\x65\x6C\x49\x64\x22\x3A\x22\x22\x2C\x22\x61\x70\x70\x49\x64\x22\x3A\x22\x22\x2C\x22\x6C\x6F\x67\x69\x6E\x53\x65\x72\x76\x65\x72\x49\x64\x22\x3A\x22\x31\x30\x30\x38\x22\x2C\x22\x6D\x61\x63\x22\x3A\x22\x22\x2C\x22\x69\x6D\x65\x69\x22\x3A\x22\x22\x2C\x22\x63\x6F\x6F\x70\x69\x64\x22\x3A\x22\x22\x2C\x22\x62\x75\x6E\x64\x6C\x65\x69\x64\x22\x3A\x22\x63\x6F\x6D\x2E\x69\x67\x61\x6D\x65\x2E\x73\x67\x71\x79\x7A\x22\x7D\x00\x00\x16\x00\x00\x00\x03\xF0\x00\x7C\x7B\x22\x70\x6C\x61\x74\x66\x6F\x72\x6D\x22\x3A\x32\x30\x2C\x22\x63\x68\x61\x6E\x6E\x65\x6C\x49\x64\x22\x3A\x22\x22\x2C\x22\x61\x70\x70\x49\x64\x22\x3A\x22\x22\x2C\x22\x6C\x6F\x67\x69\x6E\x53\x65\x72\x76\x65\x72\x49\x64\x22\x3A\x22\x31\x30\x30\x38\x22\x2C\x22\x6D\x61\x63\x22\x3A\x22\x22\x2C\x22\x69\x6D\x65\x69\x22\x3A\x22\x22\x2C\x22\x63\x6F\x6F\x70\x69\x64\x22\x3A\x22\x22\x2C\x22\x62\x75\x6E\x64\x6C\x65\x69\x64\x22\x3A\x22\x63\x6F\x6D\x2E\x69\x67\x61\x6D\x65\x2E\x73\x67\x71\x79\x7A\x22\x7D'
        #login_msg_bytes = struct.pack("!hhpppbippppppiip", 12, 1201, "", False, 1, "", "","12er31ee","1.11","2", "extra", 1101, 957, "extr2")
        login_msg_bytes= pizza.login_msg_bytes()
        print(login_msg_bytes)
        await websocket.send(login_msg_bytes)
        login_result = await websocket.recv()
        print(login_result)

        role_enter_msg_bytes = b'\x00\x11\x04\xB9\x24\xA4\x00\x00\x00\x00\x08\x26\x00\x03\x6E\x69\x6C'
        await websocket.send(role_enter_msg_bytes)
        select_result_result = await websocket.recv()
        print(select_result_result)

asyncio.get_event_loop().run_until_complete(hello())
time.sleep(0.001)
asyncio.get_event_loop().run_until_complete(hello())
